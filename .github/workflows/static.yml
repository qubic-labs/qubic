name: Simple Deploy to GitHub Pages
 
on:
  push:
    branches:
      - main
 
jobs:
  deploy:
    runs-on: ubuntu-latest
 
    permissions:
      contents: write
 
    steps:
      - name: Checkout code
        run: |
          git clone https://github.com/${{ github.repository }} .
          git fetch --all
 
      - name: Set up Node.js
        run: |
          curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
          sudo apt-get install -y nodejs
          node -v
          npm -v
 
      - name: Install dependencies
        run: npm install
        working-directory: ./culture_lab_react
 
      - name: Build the project
        run: npm run build
        working-directory: ./culture_lab_react
        env:
          CI: false
 
      - name: Deploy using gh-pages
        run: npm run deploy
        working-directory: ./culture_lab_react
        env:
          CI: false
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
